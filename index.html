<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© - Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø±Ø³Ø§Ù„ ÙˆØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©">
    <title>Ù…Ø¯Ø§Ø±Ø³ Ø¯Ø§Ù†Ø© Ø§Ù„Ø¹Ù„ÙˆÙ… - Ù…Ù†ØµØ© Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø°ÙƒÙŠØ©</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Compact Table Styles */
        .table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .data-table td {
            white-space: nowrap;
            font-size: 0.85rem !important;
            padding: 0.6rem !important;
            vertical-align: middle;
            min-width: 110px;
        }

        .data-table th {
            white-space: nowrap;
            font-size: 0.85rem;
            padding: 0.6rem !important;
        }

        /* Action Dropdown Components */
        .action-group {
            display: flex;
            align-items: center;
            gap: 2px;
            justify-content: flex-end;
            position: relative;
        }

        .action-btn-main {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid transparent;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-btn-main.send {
            background: #dcfce7;
            color: #166534;
            border-color: #bbf7d0;
        }

        .action-btn-main.remind {
            background: #fef3c7;
            color: #92400e;
            border-color: #fde68a;
        }

        .action-btn-main.verify {
            background: #e0e7ff;
            color: #3730a3;
            border-color: #c7d2fe;
        }

        .action-btn-main:hover {
            filter: brightness(0.95);
        }

        .action-dropdown-toggle {
            padding: 4px;
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            color: #64748b;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 28px;
            width: 20px;
        }

        .action-dropdown-toggle:hover {
            background: #e2e8f0;
            color: #334155;
        }

        .action-dropdown-menu {
            position: fixed;
            background: white !important;
            border: 1px solid #cbd5e1 !important;
            border-radius: 8px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
            width: 210px;
            /* Safer width for long Arabic text */
            z-index: 9999999;
            display: none;
            flex-direction: column;
            padding: 4px;
            text-align: right;
            direction: rtl;
            opacity: 0;
            transform: translateY(5px);
            transition: opacity 0.15s ease, transform 0.15s ease;
            pointer-events: none;
        }

        .action-dropdown-menu.active {
            display: flex;
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .action-dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            font-size: 0.95rem;
            /* Larger font */
            font-weight: 700;
            /* Extra bold */
            color: #1e293b;
            /* Darker color for clarity */
            background: none;
            border: none;
            width: 100%;
            text-align: right;
            border-radius: 4px;
            cursor: pointer;
            transition: none !important;
        }

        .action-dropdown-item:hover {
            background: #f1f5f9;
            color: #0f172a;
        }

        .action-dropdown-item.delete {
            color: #ef4444;
            border-top: 1px solid #f1f5f9;
            margin-top: 5px;
        }

        .action-dropdown-item.delete:hover {
            background: #fee2e2;
            color: #991b1b;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-5px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(5px);
            }
        }
    </style>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/@pdf-lib/fontkit@1.1.1/dist/fontkit.umd.min.js"></script>
    <script>
        if (typeof PDFLib === 'undefined') {
            console.warn("PDFLib failed, trying cdnjs...");
            document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"><\/script>');
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="font-data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/arabic-reshaper@2.1.0/dist/arabic-reshaper.min.js"></script>
    <script>
        if (typeof ArabicReshaper === 'undefined') {
            document.write('<script src="https://unpkg.com/arabic-reshaper@2.1.0/dist/arabic-reshaper.min.js"><\/script>');
        }
    </script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="firebase-config.js"></script>
</head>

<body class="admin-body">
    <!-- Admin Login Screen -->
    <div id="loginOverlay"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10000; display: flex; align-items: center; justify-content: center; background: #1e3a8a; overflow: hidden;">

        <!-- Premium Dynamic Background -->
        <div id="loginBg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                   background-image: url('assets/login-bg.jpg'); 
                   background-size: cover; background-position: center; 
                   filter: blur(10px) brightness(0.6); transform: scale(1.1);
                   z-index: 0;">
        </div>

        <!-- Animated Gradients -->
        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                    background: linear-gradient(135deg, rgba(30, 58, 138, 0.4) 0%, rgba(118, 75, 162, 0.4) 100%);
                    z-index: 1;">
        </div>

        <div class="card shadow-xl" style="width: 450px; padding: 3rem; text-align: center; background: rgba(255, 255, 255, 0.95); 
                   backdrop-filter: blur(20px); border-radius: 30px; position: relative; z-index: 2;
                   box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border: 1px solid rgba(255,255,255,0.3);">

            <div class="logo-container" style="margin-bottom: 2.5rem;">
                <div
                    style="background: white; width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 1.5rem; 
                            display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-lg); border: 3px solid #667eea;">
                    <img id="loginLogo" src="assets/logo.png" alt="Logo"
                        onerror="this.src='https://via.placeholder.com/200x80?text=Dana+School'"
                        style="max-height: 80px; width: auto; max-width: 90%; object-fit: contain;">
                </div>
                <h2 style="color: #1e3a8a; font-weight: 900; font-size: 1.8rem; margin-bottom: 0.5rem;">Ù…Ø¯Ø§Ø±Ø³ Ø¯Ø§Ù†Ø©
                    Ø§Ù„Ø¹Ù„ÙˆÙ…</h2>
                <div style="height: 4px; width: 60px; background: #667eea; margin: 1rem auto; border-radius: 2px;">
                </div>
                <p style="color: #64748b; font-weight: 600;">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ</p>
            </div>

            <div class="form-group" style="text-align: right; margin-bottom: 1.5rem;">
                <label
                    style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #1e3a8a; font-size: 0.9rem;">Ø§Ø³Ù…
                    Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <div style="position: relative;">
                    <input type="text" id="adminUserInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
                        style="width: 100%; padding: 1rem; padding-right: 3rem; border-radius: 15px; border: 2px solid #e2e8f0; outline: none; transition: all 0.3s; font-family: Cairo;"
                        onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 4px rgba(102, 126, 234, 0.1)'"
                        onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='none'">
                    <span
                        style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); opacity: 0.5;">ğŸ‘¤</span>
                </div>
            </div>

            <div class="form-group" style="text-align: right; margin-bottom: 2rem;">
                <label
                    style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #1e3a8a; font-size: 0.9rem;">ÙƒÙ„Ù…Ø©
                    Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <div style="position: relative;">
                    <input type="password" id="adminPassInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                        style="width: 100%; padding: 1rem; padding-right: 3rem; border-radius: 15px; border: 2px solid #e2e8f0; outline: none; transition: all 0.3s; font-family: Cairo;"
                        onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 4px rgba(102, 126, 234, 0.1)'"
                        onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='none'">
                    <span
                        style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); opacity: 0.5;">ğŸ”’</span>
                </div>
            </div>

            <button class="btn btn-primary" onclick="UI.handleLogin()" style="width: 100%; padding: 1.2rem; border-radius: 15px; font-weight: 800; font-size: 1.1rem; 
                       background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                       border: none; color: white; cursor: pointer; transition: all 0.3s;
                       box-shadow: 0 10px 25px -5px rgba(102, 126, 234, 0.5);">
                Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
            </button>
            <p id="loginError"
                style="color: #ef4444; margin-top: 1.5rem; display: none; font-weight: bold; padding: 0.75rem; background: #fee2e2; border-radius: 10px; border: 1px solid #fecaca; font-size: 0.9rem;">
                âš ï¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©</p>
        </div>
    </div>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <img id="navLogo" src="assets/logo.png" alt="Ø´Ø¹Ø§Ø± Ù…Ø¯Ø§Ø±Ø³ Ø¯Ø§Ù†Ø© Ø§Ù„Ø¹Ù„ÙˆÙ…"
                        style="height: 60px; width: auto; max-width: 200px; object-fit: contain;">
                    <h1 style="display: none;">Ù…Ø¯Ø§Ø±Ø³ Ø¯Ø§Ù†Ø© Ø§Ù„Ø¹Ù„ÙˆÙ…</h1>
                </div>
                <div class="nav-links">
                    <a href="#" class="nav-link active" data-page="dashboard">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                        </svg>
                        Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </a>
                    <a href="#" class="nav-link" data-page="students">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        Ø§Ù„Ø·Ù„Ø§Ø¨
                    </a>
                    <a href="#" class="nav-link" data-page="contracts">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        Ø§Ù„Ø¹Ù‚ÙˆØ¯
                    </a>
                    <a href="#" class="nav-link" data-page="settings">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                        Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </a>
                    <button id="themeToggle" class="btn-theme" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">
                        <svg class="sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" style="display:none;">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <div id="cloudStatus"
                        style="font-size: 0.75rem; display: flex; align-items: center; gap: 5px; color: #718096;"
                        title="Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©">
                        <span id="cloudStatusDot"
                            style="width: 8px; height: 8px; background: #cbd5e0; border-radius: 50%;"></span>
                        <span id="cloudStatusText">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</span>
                    </div>
                    <a href="#" class="nav-link" onclick="UI.handleLogout()" style="color: #ef4444;">Ø®Ø±ÙˆØ¬</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Localhost Warning -->
    <div id="localhostWarning" class="localhost-warning" style="display: none;">
        <div class="container">
            <div class="warning-content">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M12 9V13M12 17H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                <div>
                    <strong>âš ï¸ ØªØ­Ø°ÙŠØ±: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù„Ù† ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ!</strong>
                    <p>Ø´ØºÙ‘Ù„ Ù…Ù„Ù <code>start-server.bat</code> ÙˆØ§Ø³ØªØ®Ø¯Ù… <strong>http://localhost:8000</strong></p>
                </div>
                <button class="btn btn-secondary btn-small"
                    onclick="document.getElementById('localhostWarning').style.display='none'">ÙÙ‡Ù…Øª</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Contracts Management Page -->
            <div id="contracts-page" class="page">
                <!-- Modern Page Header with Gradient -->
                <div class="page-header"
                    style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%); padding: 2rem; border-radius: 16px; margin-bottom: 2rem; border: 1px solid rgba(102, 126, 234, 0.1);">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                        <div>
                            <h2
                                style="font-size: 2.2rem; font-weight: 900; background: var(--primary); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 0.5rem;">
                                ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø°ÙƒÙŠØ©</h2>
                            <p style="color: var(--text-muted); font-size: 1.05rem;">Ù…Ø±ÙƒØ² Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø¹Ù‚ÙˆØ¯
                                ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©</p>
                        </div>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <button class="btn btn-secondary" onclick="ContractUI.downloadSelectedContracts()"
                                style="box-shadow: var(--shadow);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                            </button>
                            <button class="btn btn-primary" id="newContractBtn"
                                style="box-shadow: var(--shadow-lg); animation: pulse 2s ease-in-out infinite;">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" />
                                </svg>
                                Ø¥Ø¶Ø§ÙØ© Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats Cards -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="stat-mini-card" onclick="ContractUI.filterByStatus('all')" style="cursor: pointer;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div
                                style="width: 50px; height: 50px; border-radius: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white"
                                    stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                </svg>
                            </div>
                            <div>
                                <p style="font-size: 0.85rem; color: var(--text-muted); margin: 0;">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯</p>
                                <p style="font-size: 1.8rem; font-weight: 800; color: var(--text-dark); margin: 0;"
                                    id="allContractsCount">0</p>
                            </div>
                        </div>
                    </div>

                    <div class="stat-mini-card" onclick="ContractUI.filterByStatus('signed')" style="cursor: pointer;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div
                                style="width: 50px; height: 50px; border-radius: 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white"
                                    stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </div>
                            <div>
                                <p style="font-size: 0.85rem; color: var(--text-muted); margin: 0;">Ø¹Ù‚ÙˆØ¯ Ù…ÙˆÙ‚Ø¹Ø©</p>
                                <p style="font-size: 1.8rem; font-weight: 800; color: #10b981; margin: 0;"
                                    id="signedContractsCount">0</p>
                            </div>
                        </div>
                    </div>

                    <div class="stat-mini-card" onclick="ContractUI.filterByStatus('pending')" style="cursor: pointer;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div
                                style="width: 50px; height: 50px; border-radius: 12px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white"
                                    stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12 6 12 12 16 14"></polyline>
                                </svg>
                            </div>
                            <div>
                                <p style="font-size: 0.85rem; color: var(--text-muted); margin: 0;">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p>
                                <p style="font-size: 1.8rem; font-weight: 800; color: #f59e0b; margin: 0;"
                                    id="pendingContractsCount">0</p>
                            </div>
                        </div>
                    </div>

                    <div class="stat-mini-card" onclick="ContractUI.showTemplates()" style="cursor: pointer;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div
                                style="width: 50px; height: 50px; border-radius: 12px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white"
                                    stroke-width="2">
                                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                                    <polyline points="13 2 13 9 20 9"></polyline>
                                </svg>
                            </div>
                            <div>
                                <p style="font-size: 0.85rem; color: var(--text-muted); margin: 0;">Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø¹Ù‚ÙˆØ¯</p>
                                <p style="font-size: 1.8rem; font-weight: 800; color: #3b82f6; margin: 0;"
                                    id="templatesCount">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs Navigation -->
                <div class="contracts-tabs"
                    style="display: flex; gap: 1rem; border-bottom: 2px solid var(--border); margin-bottom: 2rem; overflow-x: auto;">
                    <button class="contract-tab active" data-tab="signed" onclick="ContractUI.switchTab('signed')"
                        style="padding: 1rem 1.5rem; background: none; border: none; border-bottom: 3px solid var(--primary-solid); color: var(--primary-solid); font-weight: 700; cursor: pointer; transition: all 0.3s; white-space: nowrap;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2"
                            style="display: inline-block; margin-left: 0.5rem; vertical-align: middle;">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©
                    </button>
                    <button class="contract-tab" data-tab="templates" onclick="ContractUI.switchTab('templates')"
                        style="padding: 1rem 1.5rem; background: none; border: none; border-bottom: 3px solid transparent; color: var(--text-muted); font-weight: 600; cursor: pointer; transition: all 0.3s; white-space: nowrap;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2"
                            style="display: inline-block; margin-left: 0.5rem; vertical-align: middle;">
                            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                            <polyline points="13 2 13 9 20 9"></polyline>
                        </svg>
                        Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¹Ù‚ÙˆØ¯
                    </button>
                </div>

                <!-- Tab Content: Signed Contracts -->
                <div class="tab-content active" id="signedTab">
                    <div class="card" style="border-radius: 16px; overflow: hidden; box-shadow: var(--shadow-lg);">
                        <div class="card-header"
                            style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding: 1.5rem; border-bottom: 2px solid var(--border);">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                                <div>
                                    <h3
                                        style="font-size: 1.4rem; font-weight: 800; color: var(--text-dark); margin: 0;">
                                        ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©</h3>
                                    <p style="font-size: 0.9rem; color: var(--text-muted); margin: 0.3rem 0 0 0;">Ø¬Ù…ÙŠØ¹
                                        Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„ØªÙŠ ØªÙ… ØªÙˆÙ‚ÙŠØ¹Ù‡Ø§ Ù…Ù† Ù‚Ø¨Ù„ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</p>
                                </div>
                                <div style="display: flex; gap: 0.8rem; align-items: center; flex-wrap: wrap;">
                                    <div style="position: relative;">
                                        <input type="text" id="signedContractSearch" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨..."
                                            style="padding: 0.7rem 1rem 0.7rem 2.5rem; border: 2px solid var(--border); border-radius: 10px; width: 280px; font-size: 0.95rem; transition: all 0.3s;"
                                            onfocus="this.style.borderColor='var(--primary-solid)'"
                                            onblur="this.style.borderColor='var(--border)'">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#94a3b8"
                                            stroke-width="2"
                                            style="position: absolute; right: 0.8rem; top: 50%; transform: translateY(-50%);">
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <path d="M21 21l-4.35-4.35"></path>
                                        </svg>
                                    </div>
                                    <select id="filterSignedStatus"
                                        style="padding: 0.7rem 1rem; border: 2px solid var(--border); border-radius: 10px; font-size: 0.95rem; cursor: pointer;"
                                        onchange="ContractUI.applyFilter(this.value)">
                                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                                        <option value="signed">Ù…ÙˆÙ‚Ø¹Ø© ÙÙ‚Ø·</option>
                                        <option value="verified">Ù…ÙˆØ«Ù‚Ø© ÙÙ‚Ø·</option>
                                    </select>
                                    <button id="downloadSelectedBtn" onclick="ContractUI.downloadSelectedContracts()"
                                        style="padding: 0.7rem 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 0.5rem;">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                            <polyline points="7 10 12 15 17 10"></polyline>
                                            <line x1="12" y1="15" x2="12" y2="3"></line>
                                        </svg>
                                        ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="data-table" id="signedContractsTable" style="font-size: 0.95rem;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);">
                                        <th style="width: 50px; text-align: center;"><input type="checkbox"
                                                id="selectAllContracts"
                                                style="cursor: pointer; width: 18px; height: 18px;"></th>
                                        <th style="font-weight: 800; color: var(--text-dark);">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                        <th style="font-weight: 800; color: var(--text-dark);">ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                        <th style="font-weight: 800; color: var(--text-dark);">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</th>
                                        <th style="font-weight: 800; color: var(--text-dark);">Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø¯</th>
                                        <th style="font-weight: 800; color: var(--text-dark); text-align: center;">
                                            Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="signedContractsTableBody">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Contract Templates -->
                <div class="tab-content" id="templatesTab" style="display: none;">
                    <div style="margin-bottom: 2rem;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <div>
                                <h3
                                    style="font-size: 1.5rem; font-weight: 800; color: var(--text-dark); margin-bottom: 0.3rem;">
                                    ğŸ“„ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h3>
                                <p style="color: var(--text-muted); font-size: 0.95rem;">Ù‚ÙˆØ§Ù„Ø¨ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹
                                    Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ®ØµÙŠØµ</p>
                            </div>
                            <button class="btn btn-primary" onclick="ContractUI.openModal()"
                                style="box-shadow: var(--shadow-md);">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" />
                                </svg>
                                Ø¥Ø¶Ø§ÙØ© Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                    </div>
                    <div class="contracts-grid" id="contractsGrid"
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem;">
                        <!-- Templates populated here by JS -->
                    </div>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page active">
                <div class="page-header"
                    style="background: var(--primary-gradient); padding: 3rem; border-radius: var(--radius-lg); color: white; margin-bottom: 2.5rem; position: relative; overflow: hidden; box-shadow: var(--shadow-premium);">
                    <div
                        style="position: absolute; top: -50px; left: -50px; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%;">
                    </div>
                    <div
                        style="position: absolute; bottom: -30px; right: 10%; width: 150px; height: 150px; background: rgba(255,255,255,0.05); border-radius: 50%;">
                    </div>
                    <div style="position: relative; z-index: 1;">
                        <h2 style="font-size: 2.5rem; margin-bottom: 0.5rem; font-weight: 900; letter-spacing: -1px;">
                            Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ğŸ‘‹</h2>
                        <p style="font-size: 1.1rem; opacity: 0.9; max-width: 600px;">Ù†Ø¸Ø§Ù… Ù…Ø¯Ø§Ø±Ø³ Ø¯Ø§Ù†Ø© Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù…ØªØ·ÙˆØ±
                            Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø°ÙƒÙŠØ© ÙˆØ³Ø±ÙŠØ¹Ø©.</p>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(99, 102, 241, 0.1); color: #6366f1;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21M23 21V19C23 17.9391 22.5786 16.9217 21.8284 16.1716C21.0783 15.4214 20.0609 15 19 15H18M13 7C13 9.20914 11.2091 11 9 11C6.79086 11 5 9.20914 5 7C5 4.79086 6.79086 3 9 3C11.2091 3 13 4.79086 13 7Z"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
                            <p class="stat-number" id="totalStudents">0</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©</h3>
                            <p class="stat-number" id="signedContracts">0</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M12 8V12L15 15M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h3>
                            <p class="stat-number" id="pendingContracts">0</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: #3b82f6;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M3 8L10.89 13.26C11.2187 13.4793 11.6049 13.5963 12 13.5963C12.3951 13.5963 12.7813 13.4793 13.11 13.26L21 8M5 19H19C19.5304 19 20.0391 18.7893 20.4142 18.4142C20.7893 18.0391 21 17.5304 21 17V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H5C4.46957 5 3.96086 5.21071 3.58579 5.58579C3.21071 5.96086 3 6.46957 3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19Z"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø±Ø³Ù„Ø©</h3>
                            <p class="stat-number" id="sentContracts">0</p>
                        </div>
                    </div>
                </div>



                <!-- Analysis Charts -->
                <div class="grid-2-1"
                    style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="card p-4">
                        <div class="card-header" style="border:none; padding-bottom: 0;">
                            <h3>Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</h3>
                        </div>
                        <div style="height: 300px; padding: 1rem;">
                            <canvas id="statsChart"></canvas>
                        </div>
                    </div>
                    <div class="card p-4">
                        <div class="card-header" style="border:none; padding-bottom: 0;">
                            <h3>Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù‚ÙˆØ¯</h3>
                        </div>
                        <div style="height: 300px; padding: 1rem;">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Students Table -->
                <div class="card" style="box-shadow: var(--shadow-premium);">
                    <div class="card-header"
                        style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--border-color); padding: 2rem;">
                        <div>
                            <h3 style="font-size: 1.5rem; font-weight: 800; color: #f59e0b; margin-bottom: 0.25rem;">
                                Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…Ø·Ù„ÙˆØ¨Ø©: Ø¹Ù‚ÙˆØ¯ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</h3>
                            <p style="font-size: 0.9rem; color: var(--text-muted);">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø°ÙŠÙ† Ù„Ù… ÙŠÙˆÙ‚Ø¹ÙˆØ§ Ø§Ù„Ø¹Ù‚Ø¯
                                Ø¨Ø¹Ø¯ (Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©)</p>
                        </div>
                        <div style="display: flex; gap: 12px; align-items: center;">
                            <div style="position: relative;">
                                <input type="text" id="studentSearch" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…..."
                                    style="padding: 0.75rem 1rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: var(--radius-md); width: 300px; font-size: 0.95rem; background: var(--bg-soft); transition: var(--transition-base);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)"
                                    stroke-width="2"
                                    style="position: absolute; right: 0.8rem; top: 50%; transform: translateY(-50%);">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <path d="M21 21l-4.35-4.35"></path>
                                </svg>
                            </div>
                            <button id="deleteSelectedBtn" class="btn btn-danger" style="display: none;"
                                onclick="UI.deleteSelectedStudents()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path
                                        d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                    </path>
                                </svg>
                                Ø­Ø°Ù (<span id="selectedCount">0</span>)
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="studentsTable">
                            <thead>
                                <tr>
                                    <th style="width: 40px;"><input type="checkbox" id="selectAllDashboard"></th>
                                    <th onclick="UI.sortStudents('studentName')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ù„Ù…Ø³Ø§Ø±
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th onclick="UI.sortStudents('studentLevel')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th onclick="UI.sortStudents('studentGrade')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ù„ØµÙ
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th onclick="UI.sortStudents('parentName')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                                    <th>Ù‡ÙˆÙŠØ© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                    <th>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</th>
                                    <th onclick="UI.sortStudents('contractStatus')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø¯
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- Students Page -->
            <div id="students-page" class="page">
                <div class="page-header"
                    style="background: var(--bg-card); padding: 2.5rem; border-radius: var(--radius-lg); margin-bottom: 2.5rem; border: 1px solid var(--border-color); box-shadow: var(--shadow-md); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1.5rem;">
                    <div>
                        <h2
                            style="font-size: 2rem; font-weight: 800; color: var(--text-primary); margin-bottom: 0.25rem;">
                            Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„ÙƒÙ„ÙŠØ©</h2>
                        <p style="color: var(--text-muted); font-size: 1rem;">Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø§Ù…Ù„Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†
                            ÙˆØ¹Ù‚ÙˆØ¯Ù‡Ù….</p>
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-secondary" onclick="UI.openImportModal()" style="height: 48px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Ø§Ø³ØªÙŠØ±Ø§Ø¯ (Excel)
                        </button>
                        <button class="btn btn-primary" onclick="UI.openModal()" style="height: 48px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 5v14M5 12h14"></path>
                            </svg>
                            Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>

                <div class="card" style="box-shadow: var(--shadow-premium);">
                    <div class="card-header" style="padding: 2rem; border-bottom: 2px solid var(--border-color);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1.5rem;">
                            <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap; flex: 1;">
                                <div style="position: relative; flex: 1; min-width: 250px;">
                                    <input type="text" id="studentSearchAll"
                                        placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ØŒ Ø£Ùˆ Ø§Ù„Ù‡Ø§ØªÙ..."
                                        style="width: 100%; padding: 0.75rem 1rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 0.95rem; background: var(--bg-soft);"
                                        oninput="UI.applyFilters()">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
                                        stroke="var(--text-muted)" stroke-width="2"
                                        style="position: absolute; right: 0.85rem; top: 50%; transform: translateY(-50%);">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="M21 21l-4.35-4.35"></path>
                                    </svg>
                                </div>
                                <select id="filterLevel"
                                    style="padding: 0.75rem 1rem; border: 2px solid var(--border-color); border-radius: var(--radius-md); background: var(--bg-soft); cursor: pointer;"
                                    onchange="UI.applyFilters()">
                                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option>
                                </select>
                                <select id="filterGrade"
                                    style="padding: 0.75rem 1rem; border: 2px solid var(--border-color); border-radius: var(--radius-md); background: var(--bg-soft); cursor: pointer;"
                                    onchange="UI.applyFilters()">
                                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ</option>
                                </select>
                            </div>

                            <div style="display: flex; gap: 10px; align-items: center;">
                                <div id="filteredCountInfo"
                                    style="font-size: 0.95rem; font-weight: 700; color: var(--text-secondary); background: var(--bg-soft); padding: 0.5rem 1rem; border-radius: var(--radius-full);">
                                    <span id="filteredCount">0</span> Ø·Ù„Ø§Ø¨
                                </div>
                                <button class="btn btn-secondary" onclick="UI.exportToExcel()"
                                    style="padding: 0.6rem 1rem;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    ØªØµØ¯ÙŠØ±
                                </button>
                            </div>
                        </div>

                        <!-- Bulk Actions Bar -->
                        <div id="bulkActions"
                            style="display: none; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px dashed var(--border-color); align-items: center; gap: 12px; animation: fadeInUp 0.3s ease;">
                            <span
                                style="font-size: 0.9rem; font-weight: 700; color: var(--primary-main); margin-left: 10px;">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
                                Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©:</span>
                            <button class="btn btn-secondary" onclick="UI.startBulkAction('send')"
                                style="font-size: 0.85rem; padding: 0.5rem 1rem; color: #10b981; border-color: #10b981;">
                                ğŸ“¢ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù‚ÙˆØ¯
                            </button>
                            <button class="btn btn-secondary" onclick="UI.startBulkAction('remind')"
                                style="font-size: 0.85rem; padding: 0.5rem 1rem; color: #f59e0b; border-color: #f59e0b;">
                                ğŸ”” ØªØ°ÙƒÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯
                            </button>
                            <!-- Hidden util buttons -->
                            <button class="btn btn-secondary" onclick="UI.bulkUpdateStatus('sent')"
                                style="display:none;">DEBUG_SENT</button>

                            <button class="btn btn-secondary" onclick="UI.bulkUpdateStatus('verified')"
                                style="font-size: 0.85rem; padding: 0.5rem 1rem;">ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…Ø­Ø¯Ø¯</button>
                            <button class="btn btn-secondary" onclick="UI.bulkArchiveStudents()"
                                style="font-size: 0.85rem; padding: 0.5rem 1rem; color: #6366f1; border-color: #6366f1;">ğŸ“¦
                                Ø£Ø±Ø´ÙØ© Ø§Ù„Ù…Ø­Ø¯Ø¯</button>
                            <button id="deleteSelectedBtnMain" class="btn btn-danger"
                                style="font-size: 0.85rem; padding: 0.5rem 1rem;" onclick="UI.deleteSelectedStudents()">
                                Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯ (<span id="selectedCountMain">0</span>)
                            </button>
                        </div>
                    </div>

                    <!-- Bulk Action Queue Modal -->
                    <div id="bulkQueueModal" class="modal" style="z-index: 10000;">
                        <div class="modal-content" style="max-width: 500px; text-align: center;">
                            <div class="modal-header">
                                <h3 id="bulkQueueTitle">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ...</h3>
                                <button class="close-btn" onclick="UI.closeBulkModal()">&times;</button>
                            </div>
                            <div style="padding: 2rem;">
                                <div style="margin-bottom: 1.5rem;">
                                    <span id="bulkQueueProgress"
                                        style="font-size: 3rem; font-weight: 800; color: var(--primary-main);">1/5</span>
                                    <p style="color: var(--text-muted); margin-top: 0.5rem;">ÙŠØ±Ø¬Ù‰ Ø¹Ø¯Ù… Ø¥ØºÙ„Ø§Ù‚ Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø§ÙØ°Ø©
                                        Ø­ØªÙ‰ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</p>
                                </div>

                                <div id="bulkQueueCurrentStudent"
                                    style="background: var(--bg-soft); padding: 1rem; border-radius: 8px; margin-bottom: 2rem;">
                                    <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ù„Ù€: <strong id="bulkStudentName">-</strong></p>
                                </div>

                                <div id="bulkQueueActions">
                                    <button id="bulkNextBtn" class="btn btn-primary" onclick="UI.processNextInQueue()"
                                        style="width: 100%; padding: 1rem; font-size: 1.1rem;">
                                        ğŸš€ ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ ÙˆØ¥Ø±Ø³Ø§Ù„
                                    </button>
                                    <p style="font-size: 0.85rem; color: #f59e0b; margin-top: 10px;">
                                        âš ï¸ Ø³ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©. Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ Ø¹Ø¯ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±.
                                    </p>
                                </div>

                                <div id="bulkQueueComplete" style="display: none;">
                                    <div style="color: #10b981; font-size: 4rem; margin-bottom: 1rem;">âœ…</div>
                                    <h3>ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!</h3>
                                    <button class="btn btn-secondary" onclick="UI.closeBulkModal()"
                                        style="margin-top: 1rem;">Ø¥ØºÙ„Ø§Ù‚</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="allStudentsTable">
                            <thead>
                                <tr>
                                    <th style="width: 40px;"><input type="checkbox" id="selectAllAllStudents"></th>
                                    <th onclick="UI.sortStudents('studentName')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ù„Ù…Ø³Ø§Ø±
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th onclick="UI.sortStudents('studentLevel')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th onclick="UI.sortStudents('studentGrade')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ù„ØµÙ
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th onclick="UI.sortStudents('parentName')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                                    <th>Ù‡ÙˆÙŠØ© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                    <th>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</th>
                                    <th onclick="UI.sortStudents('contractStatus')" style="cursor: pointer;">
                                        <div style="display:flex; align-items:center; gap:5px;">
                                            Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø¯
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#3b82f6"
                                                stroke="#3b82f6" stroke-width="2">
                                                <path d="M7 15l5 5 5-5" />
                                                <path d="M7 9l5-5 5 5" />
                                            </svg>
                                        </div>
                                    </th>
                                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="allStudentsTableBody">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>



            <!-- Settings Page -->
            <div id="settings-page" class="page">
                <div class="page-header"
                    style="background: var(--bg-card); padding: 2rem; border-radius: var(--radius-lg); margin-bottom: 2rem; border: 1px solid var(--border-color); box-shadow: var(--shadow-md);">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <h2
                                style="font-size: 2rem; font-weight: 800; color: var(--text-primary); margin-bottom: 0.5rem;">
                                Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
                            <p style="color: var(--text-muted); font-size: 1rem;">Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©ØŒ Ø§Ù„Ù‡ÙŠÙƒÙ„Ø©
                                Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©ØŒ ÙˆØ§Ù„Ø£Ù…Ø§Ù†.</p>
                        </div>
                        <button class="btn btn-primary" onclick="UI.saveSettings()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                <polyline points="7 3 7 8 15 8"></polyline>
                            </svg>
                            Ø­ÙØ¸ ÙƒØ§ÙØ© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                        </button>
                    </div>
                </div>

                <!-- Settings Tabs -->
                <div class="settings-tabs">
                    <button class="tab-btn active" onclick="UI.switchSettingsTab('general')">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                        </svg>
                        Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø©
                    </button>
                    <button class="tab-btn" onclick="UI.switchSettingsTab('academic')">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                        </svg>
                        Ø§Ù„Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©
                    </button>
                    <button class="tab-btn" onclick="UI.switchSettingsTab('security')">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                        Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ø³Ø§Ø¨
                    </button>
                    <button class="tab-btn" onclick="UI.switchSettingsTab('system')">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                        Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
                    </button>
                    <button class="tab-btn" onclick="UI.switchSettingsTab('migration')">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <polyline points="17 11 19 13 23 9"></polyline>
                        </svg>
                        Ø§Ù„ØªØ±Ø­ÙŠÙ„ Ø§Ù„Ø³Ù†ÙˆÙŠ ÙˆØ§Ù„Ø£Ø±Ø´ÙØ©
                    </button>
                </div>

                <!-- Tab 1: General Settings -->
                <div id="tab-general" class="tab-content active">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem;">
                        <div class="card">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="form-group">
                                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</label>
                                    <input type="text" id="schoolName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø±Ø³Ù…ÙŠ">
                                </div>
                                <div class="form-group">
                                    <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ</label>
                                    <input type="text" id="schoolPhone" placeholder="9665xxxxxxxx">
                                    <small style="color:var(--text-muted)">ÙŠØ³ØªØ®Ø¯Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ù„Ø£ÙˆÙ„ÙŠØ§Ø¡
                                        Ø§Ù„Ø£Ù…ÙˆØ±</small>
                                </div>
                                <div class="form-group">
                                    <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙŠØ±ÙØ± (Server Link)</label>
                                    <input type="text" id="serverAddress" placeholder="http://YOUR-IP:PORT">
                                    <small style="color:var(--text-muted)">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… ÙØªØ­Ù‡ Ø¹Ù†Ø¯ Ø¶ØºØ· ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¹Ù„Ù‰
                                        Ø§Ù„Ø¹Ù‚Ø¯</small>
                                </div>
                            </div>
                        </div>



                        <div class="card">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø§Ù„Ø®ØªÙ… ÙˆØ§Ù„Ø´Ø¹Ø§Ø±</h3>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="form-group">
                                    <label>Ù†Øµ Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ</label>
                                    <input type="text" id="schoolStampInput" oninput="UI.updateStampPreview()"
                                        placeholder="Ù…Ø«Ø§Ù„: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø¨ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„">
                                </div>
                                <div class="form-group">
                                    <label>ØµÙˆØ±Ø© Ø§Ù„Ø®ØªÙ… (ØªØ¸Ù‡Ø± Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù†Øµ)</label>
                                    <input type="file" onchange="UI.handleStampUpload(this)" accept="image/*">
                                    <small style="color:var(--text-muted)">ÙŠÙØ¶Ù„ ØµÙˆØ±Ø© PNG Ø¨Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ©</small>
                                    <!-- Stamp Preview -->
                                    <div style="display: flex; justify-content: center; margin: 2rem 0;">
                                        <div class="school-stamp"
                                            style="width: 120px; height: 120px; border: 4px double var(--primary-main); border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative; color: var(--primary-main); font-weight: 900; transform: rotate(-15deg); background: rgba(99, 102, 241, 0.05);">
                                            <div
                                                style="position: absolute; width: 90%; height: 90%; border: 1px solid var(--primary-main); border-radius: 50%;">
                                            </div>
                                            <div id="stampPreviewText"
                                                style="font-size: 1rem; text-align: center; max-width: 80%; line-height: 1.2;">
                                                Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ø±Ø§Ø¨Ø· Ø£Ùˆ Ù…Ù„Ù)</label>
                                        <input type="file" onchange="UI.handleLogoUpload(this)" accept="image/*">
                                        <img id="settingsLogoPreview" src=""
                                            style="max-height: 60px; margin-top: 10px; display: block;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 2: Academic Structure -->
                <div id="tab-academic" class="tab-content">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem;">
                        <!-- Levels Manager -->
                        <div class="card">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h3>
                                <p style="font-size:0.9rem; color:var(--text-muted)">Ø£Ø¶Ù Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ù…Ø¯Ø±Ø³ØªÙƒ
                                    (Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØŒ Ù…ØªÙˆØ³Ø·...)</p>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="input-with-btn">
                                    <input type="text" id="newLevelInput"
                                        placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø­Ù„Ø© (Ù…Ø«Ø§Ù„: Ø±ÙŠØ§Ø¶ Ø£Ø·ÙØ§Ù„)">
                                    <button class="btn btn-secondary"
                                        onclick="UI.addChip('schoolLevelsInput', 'newLevelInput')">Ø¥Ø¶Ø§ÙØ©</button>
                                </div>
                                <div id="levelsChips" class="chips-container"></div>
                                <textarea id="schoolLevelsInput" style="display:none"></textarea>
                                <!-- Hidden syncing field -->
                            </div>
                        </div>

                        <!-- Grades Manager -->
                        <div class="card">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h3>
                                <p style="font-size:0.9rem; color:var(--text-muted)">Ø£Ø¶Ù Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø© (Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ØŒ
                                    Ø§Ù„Ø«Ø§Ù†ÙŠ...)</p>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="input-with-btn">
                                    <input type="text" id="newGradeInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ØµÙ">
                                    <button class="btn btn-secondary"
                                        onclick="UI.addChip('schoolGradesInput', 'newGradeInput')">Ø¥Ø¶Ø§ÙØ©</button>
                                </div>
                                <div id="gradesChips" class="chips-container"></div>
                                <textarea id="schoolGradesInput" style="display:none"></textarea>
                                <!-- Hidden syncing field -->
                            </div>
                        </div>

                        <!-- Custom Fields Manager -->
                        <div class="card" style="grid-column: 1 / -1;">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ (Custom Fields)</h3>
                                <p style="font-size:0.9rem; color:var(--text-muted)">Ø£Ø¶Ù Ø­Ù‚ÙˆÙ„Ø§Ù‹ Ù…Ø®ØµØµØ© ØªØ¸Ù‡Ø± ÙÙŠ Ù†Ù…ÙˆØ°Ø¬
                                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ (Ù…Ø«Ù„: Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©ØŒ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯)</p>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="input-with-btn">
                                    <input type="text" id="newFieldLabel"
                                        placeholder="Ø§Ø³Ù… Ø§Ù„Ø­Ù‚Ù„ (Ù…Ø«Ø§Ù„: Ø±Ù‚Ù… Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯Ù†ÙŠ)">
                                    <select id="newFieldType" style="max-width: 150px;">
                                        <option value="text">Ù†Øµ</option>
                                        <option value="number">Ø±Ù‚Ù…</option>
                                        <option value="date">ØªØ§Ø±ÙŠØ®</option>
                                    </select>
                                    <button class="btn btn-secondary" onclick="UI.addCustomField()">Ø¥Ø¶Ø§ÙØ©
                                        Ø­Ù‚Ù„</button>
                                </div>
                                <div id="customFieldsList"></div>
                                <textarea id="customFieldsSetting" style="display:none"></textarea>
                                <!-- Hidden syncing field -->
                            </div>
                        </div>

                        <!-- Auto-Assign Contracts Card -->
                        <div class="card" style="grid-column: 1 / -1;">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø±Ø¨Ø· Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª</h3>
                                <p style="font-size:0.9rem; color:var(--text-muted)">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ù…Ø³Ø§Ø±
                                    Ù„ÙŠØªÙ… Ø¥Ø³Ù†Ø§Ø¯Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨.</p>
                            </div>
                            <div class="card-body"
                                style="padding: 2rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div class="form-group">
                                    <label for="nationalContractSetting">Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø³Ø§Ø± (Ø§Ù„Ø£Ù‡Ù„ÙŠ/Ø«Ù†Ø§Ø¦ÙŠ
                                        Ø§Ù„Ù„ØºØ©)</label>
                                    <select id="nationalContractSetting">
                                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù‚Ø¯ --</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="diplomaContractSetting">Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù…Ø³Ø§Ø± (Ø§Ù„Ø¯Ø¨Ù„ÙˆÙ…Ø©)</label>
                                    <select id="diplomaContractSetting">
                                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù‚Ø¯ --</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: Security -->
                <div id="tab-security" class="tab-content">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem;">
                        <div class="card" style="border-right: 4px solid var(--primary-main);">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
                                <p style="font-size:0.85rem; color:var(--text-muted)">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØ­Ø©
                                    Ø§Ù„ØªØ­ÙƒÙ…</p>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="form-group">
                                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                                    <input type="text" id="adminUsernameSetting" placeholder="admin">
                                </div>
                                <div class="form-group">
                                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                                    <input type="password" id="adminPassSetting" placeholder="********">
                                    <small style="display:block; margin-top:5px; color:var(--text-muted)">Ø§ØªØ±ÙƒÙ‡Ø§ ÙØ§Ø±ØºØ©
                                        Ø¥Ø°Ø§ Ù„Ø§ ØªØ±ÙŠØ¯ ØªØºÙŠÙŠØ±Ù‡Ø§</small>
                                </div>
                                <button class="btn btn-primary" onclick="UI.saveSettings()" style="width:100%">ØªØ­Ø¯ÙŠØ«
                                    Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</h3>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div class="form-group">
                                    <label>Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù†Ø´Ø·Ø©</label>
                                    <p style="font-size: 0.9rem; color: var(--text-muted);">Ø£Ù†Øª Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…ØªØµÙ„ ÙƒÙ…Ø¯ÙŠØ±
                                        Ù„Ù„Ù†Ø¸Ø§Ù….</p>
                                </div>
                                <button class="btn btn-secondary" onclick="UI.logout()" style="width:100%">ØªØ³Ø¬ÙŠÙ„
                                    Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 4: System (Keep existing) -->
                <div id="tab-system" class="tab-content">
                    <!-- Cloud Settings (Existing) -->
                    <div class="card" style="box-shadow: var(--shadow-md);">
                        <div class="card-header"
                            style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: rgba(16, 185, 129, 0.03);">
                            <h3 style="display: flex; align-items: center; gap: 10px;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--success-main)"
                                    stroke-width="2">
                                    <path
                                        d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z">
                                    </path>
                                </svg>
                                Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ© (Firebase)
                            </h3>
                        </div>
                        <div class="card-body" style="padding: 2rem;">
                            <div id="cloudStatusSettings" class="status-badge status-pending"
                                style="margin-bottom: 1.5rem;">
                                Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
                            <div style="display: grid; gap: 1rem; grid-template-columns: 1fr 1fr;">
                                <button class="btn btn-primary" onclick="CloudDB.syncAllLocalToCloud()">Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                    Ù„Ù„Ø³Ø­Ø§Ø¨Ø©</button>
                                <button class="btn btn-secondary" onclick="CloudDB.syncCloudToLocal()">ØªØ­Ù…ÙŠÙ„ Ù…Ù†
                                    Ø§Ù„Ø³Ø­Ø§Ø¨Ø©</button>
                            </div>
                        </div>
                    </div>

                    <!-- Data Backup & Restore -->
                    <div class="card" style="margin-top: 2rem; box-shadow: var(--shadow-md);">
                        <div class="card-header" style="padding: 1.5rem; border-bottom: 1px solid var(--border-color);">
                            <h3
                                style="display: flex; align-items: center; gap: 10px; font-weight: 700; color: var(--text-primary);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©
                            </h3>
                            <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 5px;">
                                Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ­Ù…Ø§ÙŠØªÙ‡Ø§ Ù…Ù† Ø§Ù„Ø¶ÙŠØ§Ø¹.
                            </p>
                        </div>
                        <div class="card-body" style="padding: 2rem;">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; flex-wrap: wrap;">
                                <!-- Excel Export -->
                                <div
                                    style="border: 1px solid var(--border-color); padding: 1.5rem; border-radius: 8px;">
                                    <h4 style="margin-top:0; color: #10b981;">ğŸ“Š ØªÙ‚Ø§Ø±ÙŠØ± Ø¥ÙƒØ³Ù„ (Excel)</h4>
                                    <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1rem;">
                                        Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙÙ‚Ø·. Ù‚Ø¯ Ù„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹.
                                    </p>
                                    <button class="btn btn-secondary" onclick="UI.backupAllData()"
                                        style="width: 100%; justify-content: center;">
                                        ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø¥ÙƒØ³Ù„
                                    </button>
                                </div>

                                <!-- System Snapshot -->
                                <div
                                    style="border: 1px solid var(--primary-main); background: rgba(99, 102, 241, 0.02); padding: 1.5rem; border-radius: 8px;">
                                    <h4 style="margin-top:0; color: var(--primary-main);">ğŸ’¾ Ù„Ù‚Ø·Ø© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù†Ø¸Ø§Ù…
                                        (JSON)
                                    </h4>
                                    <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1rem;">
                                        Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ. ÙŠØ­ÙØ¸ Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹ØŒ Ø§Ù„ØµÙˆØ±ØŒ ÙˆÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø¯Ù‚Ø© 100%.
                                    </p>
                                    <div style="display: flex; gap: 10px;">
                                        <button class="btn btn-primary" onclick="UI.exportSystemJSON()"
                                            style="flex: 1; justify-content: center;">
                                            Ø­ÙØ¸ Ù†Ø³Ø®Ø© ÙƒØ§Ù…Ù„Ø©
                                        </button>
                                        <button class="btn btn-warning"
                                            onclick="document.getElementById('jsonrestoreInput').click()"
                                            style="flex: 1; justify-content: center; background: #f59e0b; border-color: #f59e0b; color: white;">
                                            Ø§Ø³ØªØ¹Ø§Ø¯Ø©
                                        </button>
                                    </div>
                                    <input type="file" id="jsonrestoreInput" accept=".json" hidden
                                        onchange="UI.importSystemJSON(this)">
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Danger Zone (Existing) -->
                    <div class="card"
                        style="margin-top: 2rem; border: 2px solid var(--danger-main); background: rgba(239, 68, 68, 0.02);">
                        <div class="card-header" style="background: rgba(239, 68, 68, 0.05); padding: 1.5rem;">
                            <h3 style="color: var(--danger-main);">Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±</h3>
                        </div>
                        <div class="card-body"
                            style="padding: 2rem; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <p style="font-weight: 700; color: var(--danger-main);">Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ù…Ø­Ù„ÙŠ + Ø³Ø­Ø§Ø¨ÙŠ)
                                </p>
                                <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 1rem;">
                                    Ø³ÙŠØªÙ… Ù…Ø³Ø­ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ø·Ù„Ø§Ø¨ØŒ Ø§Ù„Ø¹Ù‚ÙˆØ¯ØŒ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª) Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ ÙˆÙ…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ.
                                    Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!
                                </p>
                                <button class="btn btn-danger" onclick="UI.wipeAllData()">
                                    ğŸ§¨ Ù…Ø³Ø­ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 5: Annual Migration -->
                <div id="tab-migration" class="tab-content">
                    <div style="display: grid; gap: 2rem;">
                        <!-- Migration Wizard -->
                        <div class="card" style="border-right: 4px solid var(--primary-main);">
                            <div class="card-header">
                                <h3 style="font-weight:700;">Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ±Ø­ÙŠÙ„ Ø§Ù„Ø³Ù†ÙˆÙŠ (ØªØ±ÙÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨)</h3>
                                <p style="font-size:0.85rem; color:var(--text-muted)">Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù†Ù‚Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨
                                    Ù„Ù„ØµÙÙˆÙ Ø§Ù„ØªØ§Ù„ÙŠØ© ÙˆØªØµÙÙŠØ± Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹ Ù„Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.</p>
                            </div>
                            <div class="card-body" style="padding: 2rem;">
                                <div
                                    style="background: #fdf2f2; border: 1px solid #fecaca; padding: 1.25rem; border-radius: 12px; color: #991b1b; margin-bottom: 2rem; font-size: 0.95rem; border-right: 5px solid #ef4444;">
                                    <strong>âš ï¸ ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù… Ø¬Ø¯Ø§Ù‹:</strong><br>
                                    1. Ø³ÙŠØªÙ… ØªØ±ÙÙŠØ¹ ÙƒÙ„ Ø·Ø§Ù„Ø¨ Ù„Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠÙ„ÙŠÙ‡ (Ø­Ø³Ø¨ ØªØ±ØªÙŠØ¨ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                                    Ø§Ù„Ø¹Ø§Ù…Ø©).<br>
                                    2. Ø³ÙŠØªÙ… Ø£Ø±Ø´ÙØ© Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ø¨ÙƒÙ„ ØªÙˆØ§Ù‚ÙŠØ¹Ù‡Ø§ ÙˆØµÙˆØ±Ù‡Ø§) ÙÙŠ Ø³Ø¬Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø§Ù„Ø¨.<br>
                                    3. Ø³ØªØµØ¨Ø­ Ø­Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙˆÙ‚ÙŠØ¹" Ù„Ù„Ø³Ù†Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.<br>
                                    4. Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ "Ø¢Ø®Ø± ØµÙ Ø¯Ø±Ø§Ø³ÙŠ" Ø³ÙŠØªÙ… Ù†Ù‚Ù„Ù‡Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø£Ø±Ø´ÙŠÙ.
                                </div>
                                <div class="form-group" style="max-width: 500px;">
                                    <label style="font-weight:700;">Ù…Ø³Ù…Ù‰ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</label>
                                    <input type="text" id="nextYearLabel" placeholder="Ù…Ø«Ø§Ù„: 1447Ù‡Ù€ - 2026Ù…"
                                        style="padding: 12px; font-size: 1.1rem;">
                                    <small style="color:var(--text-muted)">Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ù…Ù‰ Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„ÙˆÙ„ÙŠ
                                        Ø§Ù„Ø£Ù…Ø±.</small>
                                </div>
                                <button class="btn btn-primary" onclick="UI.startMigration()"
                                    style="margin-top: 1.5rem; padding: 12px 30px; font-weight: 700;">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" style="margin-left: 8px;">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="8.5" cy="7" r="4"></circle>
                                        <line x1="20" y1="8" x2="20" y2="14"></line>
                                        <line x1="23" y1="11" x2="17" y2="11"></line>
                                    </svg>
                                    ØªØ£ÙÙŠØ° ØªØ±Ø­ÙŠÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ù„Ù„Ø³Ù†Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
                                </button>
                            </div>
                        </div>

                        <!-- Archive Explorer -->
                        <div class="card">
                            <div class="card-header"
                                style="display:flex; justify-content:space-between; align-items:center;">
                                <div>
                                    <h3 style="font-weight:700;">Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªØ®Ø±Ø¬ÙŠÙ† ÙˆØ§Ù„Ù‚Ø¯Ø§Ù…Ù‰</h3>
                                    <p style="font-size:0.85rem; color:var(--text-muted)">Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø°ÙŠÙ† ØªÙ… Ø£Ø±Ø´ÙØªÙ‡Ù… ÙÙŠ
                                        Ø³Ù†ÙˆØ§Øª Ø³Ø§Ø¨Ù‚Ø©.</p>
                                </div>
                                <button class="btn btn-secondary btn-sm" onclick="UI.refreshArchiveTable()">ØªØ­Ø¯ÙŠØ«
                                    Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
                            </div>
                            <div class="card-body" style="padding: 1rem;">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                                <th>Ø§Ù„ØªØ®ØµØµ/Ø§Ù„Ù…Ø³Ø§Ø±</th>
                                                <th>Ø¢Ø®Ø± ØµÙ</th>
                                                <th>Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</th>
                                            </tr>
                                        </thead>
                                        <tbody id="archiveTableBody">
                                            <tr>
                                                <td colspan="4" style="text-align:center;">ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø´ÙŠÙ...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- New Student Modal -->
    <div class="modal" id="newStudentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="close-btn" id="closeModalBtn">&times;</button>
            </div>
            <form id="studentForm" class="form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="studentName">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                        <input type="text" id="studentName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„">
                    </div>
                    <div class="form-group">
                        <label for="studentNationality">Ø§Ù„Ø¬Ù†Ø³ÙŠØ©</label>
                        <select id="studentNationality">
                            <option value="Ø³Ø¹ÙˆØ¯ÙŠ">Ø³Ø¹ÙˆØ¯ÙŠ</option>
                            <option value="ØºÙŠØ± Ø³Ø¹ÙˆØ¯ÙŠ">ØºÙŠØ± Ø³Ø¹ÙˆØ¯ÙŠ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="studentTrack">Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</label>
                        <select id="studentTrack" onchange="UI.autoSelectContract()">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø§Ø±</option>
                            <option value="Ù…Ø³Ø§Ø± Ø«Ù†Ø§Ø¦ÙŠ Ø§Ù„Ù„ØºØ©">Ù…Ø³Ø§Ø± Ø«Ù†Ø§Ø¦ÙŠ Ø§Ù„Ù„ØºØ©</option>
                            <option value="Ù…Ø³Ø§Ø± Ø¯Ø¨Ù„ÙˆÙ…Ø§ Ø£Ù…Ø±ÙŠÙƒÙŠØ©">Ù…Ø³Ø§Ø± Ø¯Ø¨Ù„ÙˆÙ…Ø§ Ø£Ù…Ø±ÙŠÙƒÙŠØ©</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="studentLevel">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                        <select id="studentLevel" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø©</option>
                            <!-- Populated dynamically -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="studentGrade">Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                        <select id="studentGrade" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                            <!-- Populated dynamically -->
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="explicitNationalId">Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                        <input type="number" id="explicitNationalId" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©/Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="parentName">Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</label>
                        <input type="text" id="parentName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±">
                    </div>
                    <div class="form-group">
                        <label for="parentNationalId">Ù‡ÙˆÙŠØ© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</label>
                        <input type="number" id="parentNationalId" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="parentEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="parentEmail" required placeholder="example@email.com">
                    </div>
                    <div class="form-group">
                        <label for="parentWhatsapp">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
                        <input type="tel" id="parentWhatsapp" required placeholder="+966xxxxxxxxx">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="sendMethod">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</label>
                        <select id="sendMethod" required>
                            <option value="">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</option>
                            <option value="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</option>
                            <option value="whatsapp">Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</option>
                            <option value="both">ÙƒÙ„Ø§Ù‡Ù…Ø§</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="registrationType">Ù†ÙˆØ¹ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                        <select id="registrationType" required>
                            <option value="existing">Ù…Ù†ØªØ¸Ù…</option>
                            <option value="mustajid">Ù…Ø³ØªØ¬Ø¯</option>
                        </select>
                    </div>
                </div>

                <div id="dynamicCustomFieldsContainer" class="form-row" style="flex-wrap: wrap; gap: 1rem;">
                    <!-- Dynamic fields will be inserted here -->
                </div>

                <div class="form-group">
                    <label for="contractYear">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                    <input type="text" id="contractYear" required placeholder="2024-2025">
                </div>

                <div class="form-group">
                    <label for="contractTemplate">Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ù‚Ø¯</label>
                    <select id="contractTemplate" required>
                        <option value="">Ø§Ø®ØªØ± Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ù‚Ø¯</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="UI.closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-primary">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M17 8L8 17L3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                        Ø­ÙØ¸ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ù‚Ø¯
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Excel Import Modal -->
    <div class="modal" id="importModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ (Ù…Ù„Ù Excel)</h3>
                <button class="close-btn" onclick="UI.closeImportModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div style="text-align: center; margin-bottom: 25px;">
                    <p style="color: #64748b; margin-bottom: 15px;">Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </p>
                    <button class="btn btn-secondary" onclick="UI.downloadExcelTemplate()"
                        style="width: 100%; justify-content: center; background: #f8fafc; border: 1px solid #e2e8f0; color: #1e293b;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" style="margin-left:8px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        1. ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„
                    </button>
                    <p style="font-size: 12px; color: #94a3b8; margin-top: 5px;">ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                        (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø¬ÙˆØ§Ù„ØŒ Ø¥Ù„Ø®.)</p>
                </div>

                <hr style="border: 0; border-top: 1px solid #f1f5f9; margin: 20px 0;">

                <div style="text-align: center;">
                    <p style="color: #64748b; margin-bottom: 15px;">Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ø¹Ø¯ ØªØ¹Ø¨Ø¦ØªÙ‡</p>
                    <div class="upload-area" onclick="document.getElementById('excelUpload').click()"
                        style="cursor: pointer; border: 2px dashed #6366f1; background: #f5f3ff; padding: 30px; border-radius: 12px; transition: all 0.3s;">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2"
                            style="margin-bottom: 10px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <p style="color: #4338ca; font-weight: 600;">2. Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„ Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ</p>
                        <p style="font-size: 12px; color: #6366f1;">ÙŠØ¯Ø¹Ù… Ù…Ù„ÙØ§Øª .xlsx, .xls</p>
                        <input type="file" id="excelUpload" accept=".xlsx, .xls, .csv" hidden
                            onchange="UI.importFromExcel(this)">
                    </div>
                </div>
            </div>
            <div class="modal-footer"
                style="padding: 15px; background: #f8fafc; text-align: left; border-radius: 0 0 16px 16px;">
                <button class="btn btn-secondary" onclick="UI.closeImportModal()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <!-- Success Notification -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                    d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <span id="notificationText"></span>
        </div>
    </div>


    <!--Contract Editor Modal -->
    <div class="modal" id="contractEditorModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="contractModalTitle">Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù‚Ø¯ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="close-btn" id="closeContractModalBtn">&times;</button>
            </div>
            <form id="contractForm" class="form">
                <div class="form-group">
                    <label for="contractTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù‚Ø¯</label>
                    <input type="text" id="contractTitle" required placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù‚Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨ 2024-2025">
                </div>
                <div class="form-group">
                    <label>Ø·Ø±ÙŠÙ‚Ø© Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„Ø¹Ù‚Ø¯</label>
                    <div class="input-method-tabs">
                        <button type="button" class="input-tab active" data-method="write"
                            onclick="ContractUI.switchInputMethod('write')">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M14 2L18 6L7 17H3V13L14 2Z" stroke="currentColor" stroke-width="2" />
                            </svg>
                            ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Øµ
                        </button>
                        <button type="button" class="input-tab" data-method="upload"
                            onclick="ContractUI.switchInputMethod('upload')">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M10 3V13M10 3L6 7M10 3L14 7" stroke="currentColor" stroke-width="2" />
                            </svg>
                            Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Øµ
                        </button>
                        <button type="button" class="input-tab" id="pdfTemplateTabBtn" data-method="pdf_template"
                            onclick="ContractUI.switchInputMethod('pdf_template')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            Ù‚Ø§Ù„Ø¨ PDF
                        </button>
                    </div>
                </div>
                <div class="input-method" id="writeMethod">
                    <div class="form-group">
                        <label for="contractText">Ù†Øµ Ø§Ù„Ø¹Ù‚Ø¯</label>
                        <div class="variables-helper">
                            <div class="variables-header">
                                <strong>Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©:</strong>
                                <small>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ØªØºÙŠØ± Ù„Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ù†Øµ</small>
                            </div>
                            <div class="variables-tags">
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ø³Ù…_Ø§Ù„Ø·Ø§Ù„Ø¨}')">{Ø§Ø³Ù…_Ø§Ù„Ø·Ø§Ù„Ø¨}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ø³Ù…_ÙˆÙ„ÙŠ_Ø§Ù„Ø§Ù…Ø±}')">{Ø§Ø³Ù…_ÙˆÙ„ÙŠ_Ø§Ù„Ø§Ù…Ø±}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ù„ØµÙ}')">{Ø§Ù„ØµÙ}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ù„Ù…Ø±Ø­Ù„Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}')">{Ø§Ù„Ù…Ø±Ø­Ù„Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ù„Ù…Ø±Ø­Ù„Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}')">{Ø§Ù„Ù…Ø±Ø­Ù„Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ù„Ø³Ù†Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}')">{Ø§Ù„Ø³Ù†Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ù„Ø¨Ø±ÙŠØ¯_Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ}')">{Ø§Ù„Ø¨Ø±ÙŠØ¯_Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø±Ù‚Ù…_Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨}')">{Ø±Ù‚Ù…_Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨}</button>
                                <button type="button" class="var-tag"
                                    onclick="ContractUI.insertVariable('{Ø§Ù„ØªØ§Ø±ÙŠØ®}')">{Ø§Ù„ØªØ§Ø±ÙŠØ®}</button>
                            </div>
                        </div>
                        <textarea id="contractText" rows="15" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¹Ù‚Ø¯ Ù‡Ù†Ø§...

Ù…Ø«Ø§Ù„: Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: {Ø§Ø³Ù…_Ø§Ù„Ø·Ø§Ù„Ø¨}
Ø§Ù„ØµÙ: {Ø§Ù„ØµÙ}"></textarea>
                    </div>
                </div>
                <div class="input-method" id="uploadMethod" style="display: none;">
                    <div class="upload-area" id="contractUploadArea">
                        <svg width="60" height="60" viewBox="0 0 60 60">
                            <path d="M30 10V40M30 40L40 30M30 40L20 30" stroke="#667eea" stroke-width="3" />
                        </svg>
                        <h3>Ø§Ø³Ø­Ø¨ Ù…Ù„Ù PDF Ø£Ùˆ Word Ù‡Ù†Ø§</h3>
                        <!-- DIRECT BINDING -->
                        <input type="file" id="contractFileInput" accept=".pdf,.doc,.docx,.txt" hidden
                            onchange="ContractUI.handleFileUpload(this)">
                        <button type="button" class="btn btn-secondary" id="browseContractFile"
                            onclick="document.getElementById('contractFileInput').click()">ØªØµÙØ­</button>
                    </div>
                    <div id="uploadedContractPreview" style="display: none; margin-top: 1rem;">
                        <p id="uploadedContractName"></p>
                        <textarea id="extractedText" rows="12"></textarea>
                        <button type="button" class="btn-icon" id="removeContractFile" style="margin-top: 0.5rem;"
                            onclick="ContractUI.resetUpload()">Ø­Ø°Ù
                            Ø§Ù„Ù…Ù„Ù</button>
                        <button type="button" class="btn btn-primary" id="useUploadedTextBtn"
                            style="margin-top: 0.5rem; margin-right: 10px;" onclick="ContractUI.useUploadedText()">
                            ØªØ­Ø±ÙŠØ± ÙˆØ¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ±Ø§Øª
                        </button>
                    </div>
                </div>

                <!-- NEW PDF TEMPLATE METHOD -->
                <div class="input-method" id="pdfTemplateMethod" style="display: none;">

                    <!-- 1. Upload Section -->
                    <div class="upload-area" id="pdfTemplateUploadArea" style="margin-bottom: 20px;">
                        <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        <h3>Ø±ÙØ¹ Ù‚Ø§Ù„Ø¨ PDF ÙØ§Ø±Øº</h3>
                        <p style="color:#718096; font-size: 0.9rem;">Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙƒØ®Ù„ÙÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯</p>
                        <!-- DIRECT BINDING -->
                        <input type="file" id="pdfTemplateInput" accept=".pdf" hidden
                            onchange="ContractUI.handlePdfTemplateUpload(this)">
                        <button type="button" class="btn btn-secondary"
                            onclick="document.getElementById('pdfTemplateInput').click()">Ø§Ø®ØªØ± Ù…Ù„Ù PDF</button>
                    </div>

                    <!-- 2. Editor Container (Hidden until upload) -->
                    <div id="pdfTemplateEditor" style="display: none;">

                        <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                            <div style="flex: 1;">
                                <h4>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨</h4>
                                <p style="font-size: 12px; color: #666;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØªØºÙŠØ± ÙÙŠÙ‡</p>
                            </div>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <button type="button" class="btn btn-secondary btn-sm" id="prevPageBtn"
                                    title="Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©">&lt;</button>
                                <span id="pageInfo">ØµÙØ­Ø© 1 / 1</span>
                                <button type="button" class="btn btn-secondary btn-sm" id="nextPageBtn"
                                    title="Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©">&gt;</button>
                            </div>
                        </div>

                        <div style="display: flex; gap: 20px; align-items: flex-start;">

                            <!-- Sidebar Tools -->
                            <div
                                style="width: 250px; flex-shrink: 0; background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0;">
                                <h5 style="margin-top: 0; margin-bottom: 10px;">Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h5>
                                <div id="pdfVariablesList" style="display: flex; flex-direction: column; gap: 8px;">
                                    <!-- Standard Variables -->
                                    <button type="button" class="var-btn" data-var="{Ø§Ø³Ù…_Ø§Ù„Ø·Ø§Ù„Ø¨}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ø³Ù…_Ø§Ù„Ø·Ø§Ù„Ø¨}')">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ø³Ù…_ÙˆÙ„ÙŠ_Ø§Ù„Ø§Ù…Ø±}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ø³Ù…_ÙˆÙ„ÙŠ_Ø§Ù„Ø§Ù…Ø±}')">Ø§Ø³Ù… ÙˆÙ„ÙŠ
                                        Ø§Ù„Ø£Ù…Ø±</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ù„ØµÙ}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ù„ØµÙ}')">Ø§Ù„ØµÙ</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ù„Ù…Ø±Ø­Ù„Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ù„Ù…Ø±Ø­Ù„Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}')">Ø§Ù„Ù…Ø±Ø­Ù„Ø©
                                        Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ù„Ø³Ù†Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ù„Ø³Ù†Ø©_Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©}')">Ø§Ù„Ø³Ù†Ø©
                                        Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ù„ØªØ§Ø±ÙŠØ®}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ù„ØªØ§Ø±ÙŠØ®}')">Ø§Ù„ØªØ§Ø±ÙŠØ®</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ù„ØªÙˆÙ‚ÙŠØ¹}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ù„ØªÙˆÙ‚ÙŠØ¹}')">Ù…ÙƒØ§Ù† Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
                                        (ØµÙˆØ±Ø©)</button>
                                    <button type="button" class="var-btn" data-var="{Ø§Ù„Ø®ØªÙ…}"
                                        onclick="ContractUI.handleVariableClick('{Ø§Ù„Ø®ØªÙ…}')">Ù…ÙƒØ§Ù† Ø§Ù„Ø®ØªÙ… (ØµÙˆØ±Ø©)</button>

                                    <!-- Dynamic fields will be appended here -->
                                </div>

                                <h5 style="margin-top: 20px; margin-bottom: 10px;">Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø¶Ø§ÙØ©</h5>
                                <ul id="addedFieldsList"
                                    style="list-style: none; padding: 0; margin: 0; font-size: 12px; max-height: 200px; overflow-y: auto;">
                                    <!-- Populated items -->
                                </ul>
                            </div>

                            <!-- PDF Canvas -->
                            <div
                                style="flex: 1; position: relative; border: 1px solid #ccc; background: #525659; overflow: auto; max-height: 600px; text-align: center;">
                                <div id="pdfCanvasContainer" style="position: relative; display: inline-block;">
                                    <canvas id="the-canvas" style="border: 1px solid black; direction: ltr;"></canvas>
                                    <div id="pdfFieldsOverlay"
                                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; direction: ltr;">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="setAsDefault">
                        <span>ØªØ¹ÙŠÙŠÙ† ÙƒØ¹Ù‚Ø¯ Ø§ÙØªØ±Ø§Ø¶ÙŠ</span>
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelContractBtn">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-primary">Ø­ÙØ¸ Ø§Ù„Ø¹Ù‚Ø¯</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Force cache invalidation for main scripts
        const timestamp = Date.now();
        document.write('<script src="contracts.js?t=' + timestamp + '"><\/script>');
        document.write('<script src="script.js?t=' + timestamp + '"><\/script>');
    </script>
    <!-- Preview Modal -->
    <div id="contractPreviewModal" class="modal">
        <div class="modal-content" style="max-width: 850px;">
            <div class="modal-header">
                <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¹Ù‚Ø¯</h3>
                <button class="close-btn" onclick="UI.closePreviewModal()">&times;</button>
            </div>
            <div id="contractPreviewBody" style="padding: 2rem; background: #fff; direction: rtl;">
                <!-- Content injected by JS -->
            </div>
            <div class="form-actions" style="padding: 1.5rem; justify-content: center;">
                <button class="btn btn-secondary" onclick="UI.closePreviewModal()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
            </div>
        </div>
    </div>

    <script>
        // Emergency Logo Recovery
        document.querySelectorAll('img').forEach(img => {
            img.onerror = function () {
                if (this.src.includes('logo.png')) {
                    console.warn("Logo failed to load, trying fallback...");
                    // Try to load from Firebase setting or a placeholder if local fails
                    const settings = JSON.parse(localStorage.getItem('appSettings') || '{}');
                    if (settings.schoolLogo) {
                        this.src = settings.schoolLogo;
                    } else {
                        this.src = 'https://via.placeholder.com/200x80?text=Dana+AI+School';
                    }
                }
            };
        });
    </script>
</body>

</html>